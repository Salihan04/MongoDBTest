import java.util.ArrayList;

import model.Person;

import com.mongodb.BasicDBObject;
import com.mongodb.DBCollection;

import utilities.Utilities;

public class MongoDBJDBC {
	private static String hostName;
	private static int port;
	private static String database;
	private static String collectionName;
	private static DBCollection collection;
	
	public static void main(String args[]) {
		int i;
		
		hostName = "localhost";
		port = 27017;
		database = "test";
		collectionName = "people";
		
		try {
			Utilities.connectToDB(hostName, port, database);
			
			collection = Utilities.getDatabase().getCollection(collectionName);
			if(collection == null) {
				Utilities.createCollection(collectionName);
			}
			else {
				System.out.println("Collection '" + collectionName + "' selected successfully");
			}
			
			Person person = new Person("Tom", "male", 24);
			ArrayList<String> personParams = Person.getPersonParams();
			int numParams = Person.getNumOfPersonParams();
			ArrayList<Object> paramValues = person.getParamValues();
			
			//Inserting document
			BasicDBObject doc = new BasicDBObject();
			for(i = 0; i < numParams; i ++) {
				doc.append(personParams.get(i), paramValues.get(i));
			}
			collection.insert(doc);
			System.out.println("Document inserted successfully");
						
			
		}catch(Exception e) {
			System.err.println(e.getClass().getName() + ": " + e.getMessage());
		}
	}
}
